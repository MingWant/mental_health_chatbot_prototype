# å¿ƒç†å¥åº·è‡ªæˆ‘é—œæ‡·èŠå¤©æ©Ÿå™¨äºº

ä¸€å€‹å°ˆé–€ç‚ºå­¸ç”Ÿè¨­è¨ˆçš„å¿ƒç†å¥åº·è‡ªæˆ‘é—œæ‡·èŠå¤©æ©Ÿå™¨äººç³»çµ±ï¼Œçµåˆäº†Agentã€Chatbotå’ŒRAGæŠ€è¡“ï¼Œæä¾›å°ˆæ¥­çš„å¿ƒç†å¥åº·æ”¯æŒå’Œè‡ªæˆ‘é—œæ‡·ç­–ç•¥ã€‚

## ğŸ¯ ç³»çµ±ç‰¹è‰²

### æ ¸å¿ƒåŠŸèƒ½
- **æƒ…ç·’è©•ä¼°èˆ‡åˆ†æ** - æ™ºèƒ½åˆ†æç”¨æˆ¶æƒ…ç·’ç‹€æ…‹
- **å€‹æ€§åŒ–æ‡‰å°ç­–ç•¥** - æ ¹æ“šæƒ…ç·’é¡å‹æä¾›å®šåˆ¶åŒ–å»ºè­°
- **å†¥æƒ³æŒ‡å°** - æä¾›ä¸åŒç´šåˆ¥çš„å†¥æƒ³ç·´ç¿’
- **ç¡çœ å»ºè­°** - æ”¹å–„ç¡çœ è³ªé‡çš„å°ˆæ¥­å»ºè­°
- **å­¸ç¿’å¥åº·å»ºè­°** - å­¸ç¿’éç¨‹ä¸­çš„å¿ƒç†å¥åº·æŒ‡å°
- **è‡ªæˆ‘é—œæ‡·è¨ˆåŠƒ** - åˆ¶å®šå€‹æ€§åŒ–çš„è‡ªæˆ‘é—œæ‡·è¨ˆåŠƒ
- **å¿ƒç†å¥åº·è³‡æº** - æä¾›å°ˆæ¥­è³‡æºå’Œç·Šæ€¥è¯ç¹«æ–¹å¼
- **å¿ƒæƒ…è¿½è¹¤** - å¹«åŠ©ç”¨æˆ¶è¨˜éŒ„å’Œè¿½è¹¤å¿ƒç†å¥åº·ç‹€æ³

### æŠ€è¡“ç‰¹è‰²
- **Agent + Chatbot + RAG** ä¸‰åˆä¸€æ¶æ§‹
- **æ™ºèƒ½æƒ…ç·’è­˜åˆ¥** - åŸºæ–¼é—œéµè©çš„æƒ…ç·’åˆ†æ
- **å°ˆæ¥­å·¥å…·é›†** - è±å¯Œçš„å¿ƒç†å¥åº·å°ˆæ¥­å·¥å…·
- **RAGçŸ¥è­˜åº«** - æ”¯æŒä¸Šå‚³å’Œç®¡ç†å¿ƒç†å¥åº·æ–‡æª”
- **æœƒè©±è¨˜æ†¶** - ä¿æŒå°è©±ä¸Šä¸‹æ–‡é€£çºŒæ€§
- **æµå¼è¼¸å‡º** - å¯¦æ™‚éŸ¿æ‡‰ç”¨æˆ¶éœ€æ±‚

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. å®‰è£ä¾è³´

```bash
pip install -r requirements.txt
```

### 2. å•Ÿå‹•æœå‹™å™¨

```bash
# æ–¹æ³•1: ä½¿ç”¨å•Ÿå‹•è…³æœ¬
python start_mental_health_server.py

# æ–¹æ³•2: ç›´æ¥å•Ÿå‹•
uvicorn mental_health_server:app --host 0.0.0.0 --port 8001 --reload
```

### 3. è¨ªå•æœå‹™

- **æœå‹™å™¨åœ°å€**: http://localhost:8001
- **APIæ–‡æª”**: http://localhost:8001/docs
- **å¥åº·æª¢æŸ¥**: http://localhost:8001/health

## ğŸ“š API ç«¯é»

### èŠå¤©ç›¸é—œ
- `POST /api/v1/chat/messages` - ç™¼é€æ¶ˆæ¯ä¸¦ç²å–AIå›è¦†
- `POST /api/v1/chat/stream` - æµå¼èŠå¤©API
- `GET /api/v1/chat/sessions` - ç²å–æœƒè©±åˆ—è¡¨
- `POST /api/v1/chat/sessions` - å‰µå»ºæ–°æœƒè©±
- `GET /api/v1/chat/sessions/{session_id}/messages` - ç²å–æœƒè©±æ¶ˆæ¯
- `DELETE /api/v1/chat/sessions/{session_id}` - åˆªé™¤æœƒè©±

### å¿ƒç†å¥åº·å·¥å…·
- `POST /api/v1/mental-health/assess` - æƒ…ç·’è©•ä¼°
- `POST /api/v1/mental-health/coping-strategies` - ç²å–æ‡‰å°ç­–ç•¥
- `POST /api/v1/mental-health/meditation` - ç²å–å†¥æƒ³æŒ‡å°
- `GET /api/v1/mental-health/sleep-advice` - ç²å–ç¡çœ å»ºè­°
- `GET /api/v1/mental-health/study-wellness` - ç²å–å­¸ç¿’å¥åº·å»ºè­°
- `POST /api/v1/mental-health/self-care-plan` - å‰µå»ºè‡ªæˆ‘é—œæ‡·è¨ˆåŠƒ
- `GET /api/v1/mental-health/resources` - ç²å–å¿ƒç†å¥åº·è³‡æº
- `GET /api/v1/mental-health/mood-tracker` - ç”Ÿæˆå¿ƒæƒ…è¿½è¹¤å™¨

### RAGç®¡ç†
- `POST /api/v1/mental-health-rag/upload` - ä¸Šå‚³å¿ƒç†å¥åº·æ–‡æª”
- `GET /api/v1/mental-health-rag/search` - æœç´¢çŸ¥è­˜åº«
- `GET /api/v1/mental-health-rag/search-by-category` - æŒ‰é¡åˆ¥æœç´¢
- `GET /api/v1/mental-health-rag/documents` - ç²å–æ–‡æª”åˆ—è¡¨
- `GET /api/v1/mental-health-rag/documents/{doc_id}` - ç²å–æ–‡æª”å…§å®¹
- `DELETE /api/v1/mental-health-rag/documents/{doc_id}` - åˆªé™¤æ–‡æª”
- `GET /api/v1/mental-health-rag/categories` - ç²å–å¯ç”¨é¡åˆ¥
- `GET /api/v1/mental-health-rag/stats` - ç²å–çµ±è¨ˆä¿¡æ¯

## ğŸ› ï¸ ç³»çµ±æ¶æ§‹

### æ ¸å¿ƒçµ„ä»¶

1. **mental_health_tools.py** - å¿ƒç†å¥åº·å·¥å…·é›†
   - æƒ…ç·’è©•ä¼°å·¥å…·
   - æ‡‰å°ç­–ç•¥å·¥å…·
   - å†¥æƒ³æŒ‡å°å·¥å…·
   - ç¡çœ å»ºè­°å·¥å…·
   - å­¸ç¿’å¥åº·å·¥å…·
   - è‡ªæˆ‘é—œæ‡·è¨ˆåŠƒå·¥å…·
   - å¿ƒç†å¥åº·è³‡æºå·¥å…·
   - å¿ƒæƒ…è¿½è¹¤å·¥å…·
   - RAGçŸ¥è­˜åº«æŸ¥è©¢å·¥å…·

2. **mental_health_server.py** - ä¸»æœå‹™å™¨
   - FastAPIæ‡‰ç”¨
   - AutoGen Agenté›†æˆ
   - æœƒè©±ç®¡ç†
   - æµå¼è¼¸å‡º
   - APIç«¯é»

3. **mental_health_rag_service.py** - RAGæœå‹™
   - æ–‡æª”è™•ç†
   - å‘é‡åŒ–å­˜å„²
   - ç›¸ä¼¼åº¦æœç´¢
   - é¡åˆ¥åˆ†é¡

4. **mental_health_rag_api.py** - RAGç®¡ç†API
   - æ–‡æª”ä¸Šå‚³
   - çŸ¥è­˜åº«æœç´¢
   - æ–‡æª”ç®¡ç†

5. **chat_history_manager.py** - èŠå¤©è¨˜éŒ„ç®¡ç†
   - æœƒè©±å­˜å„²
   - æ¶ˆæ¯è¨˜éŒ„
   - æ­·å²æŸ¥è©¢

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### 1. æƒ…ç·’è©•ä¼°

```python
import requests

# è©•ä¼°æƒ…ç·’ç‹€æ…‹
response = requests.post("http://localhost:8001/api/v1/mental-health/assess", 
                        json={"message": "æˆ‘ä»Šå¤©æ„Ÿè¦ºå¾ˆç„¦æ…®ï¼Œç¡ä¸å¥½è¦º"})
print(response.json())
```

### 2. ç²å–æ‡‰å°ç­–ç•¥

```python
# ç²å–ç„¦æ…®çš„æ‡‰å°ç­–ç•¥
response = requests.post("http://localhost:8001/api/v1/mental-health/coping-strategies",
                        params={"emotion": "ç„¦æ…®", "intensity": "ä¸­"})
print(response.json())
```

### 3. èŠå¤©å°è©±

```python
# ç™¼é€èŠå¤©æ¶ˆæ¯
response = requests.post("http://localhost:8001/api/v1/chat/messages",
                        json={
                            "session_id": "test_session",
                            "message": "æˆ‘æœ€è¿‘å­¸ç¿’å£“åŠ›å¾ˆå¤§ï¼Œè©²æ€éº¼è¾¦ï¼Ÿ",
                            "agent_type": "mental_health"
                        })
print(response.json())
```

### 4. ä¸Šå‚³å¿ƒç†å¥åº·æ–‡æª”

```python
# ä¸Šå‚³PDFæ–‡æª”
with open("mental_health_guide.pdf", "rb") as f:
    files = {"file": f}
    response = requests.post("http://localhost:8001/api/v1/mental-health-rag/upload", 
                           files=files)
print(response.json())
```

## ğŸ”§ é…ç½®èªªæ˜

### ç’°å¢ƒè®Šé‡
- `OPENAI_API_KEY` - OpenAI APIå¯†é‘°
- `OPENAI_BASE_URL` - OpenAI APIåŸºç¤URL
- `MODEL_NAME` - ä½¿ç”¨çš„æ¨¡å‹åç¨±

### ç›®éŒ„çµæ§‹
```
backend/
â”œâ”€â”€ mental_health_server.py          # ä¸»æœå‹™å™¨
â”œâ”€â”€ mental_health_tools.py           # å¿ƒç†å¥åº·å·¥å…·
â”œâ”€â”€ mental_health_rag_service.py     # RAGæœå‹™
â”œâ”€â”€ mental_health_rag_api.py         # RAG API
â”œâ”€â”€ chat_history_manager.py          # èŠå¤©è¨˜éŒ„ç®¡ç†
â”œâ”€â”€ llms.py                          # LLMå®¢æˆ¶ç«¯
â”œâ”€â”€ requirements.txt                 # ä¾è³´åŒ…
â”œâ”€â”€ start_mental_health_server.py    # å•Ÿå‹•è…³æœ¬
â”œâ”€â”€ README_mental_health.md          # èªªæ˜æ–‡æª”
â”œâ”€â”€ chat_history/                    # èŠå¤©è¨˜éŒ„å­˜å„²
â”œâ”€â”€ mental_health_uploads/           # æ–‡æª”ä¸Šå‚³ç›®éŒ„
â”œâ”€â”€ mental_health_chroma_db/         # å‘é‡æ•¸æ“šåº«
â””â”€â”€ exports/                         # å°å‡ºæ–‡ä»¶
```

## ğŸ¨ ç³»çµ±æç¤ºè©

ç³»çµ±ä½¿ç”¨å°ˆæ¥­çš„å¿ƒç†å¥åº·æç¤ºè©ï¼ŒåŒ…å«ï¼š

1. **è§’è‰²å®šç¾©** - å°ˆæ¥­ã€æº«æš–ã€å¯Œæœ‰åŒç†å¿ƒçš„å¿ƒç†å¥åº·åŠ©æ‰‹
2. **æ ¸å¿ƒä½¿å‘½** - å¹«åŠ©å­¸ç”Ÿç®¡ç†æƒ…ç·’å¥åº·ï¼Œæä¾›å¯¦ç”¨çš„è‡ªæˆ‘é—œæ‡·ç­–ç•¥
3. **æ ¸å¿ƒåƒ¹å€¼è§€** - åŒç†å¿ƒã€å°ˆæ¥­æ€§ã€å®‰å…¨æ€§ã€å€‹æ€§åŒ–ã€å¸Œæœ›
4. **å°ˆæ¥­å·¥å…·é›†** - 8å€‹å°ˆæ¥­å¿ƒç†å¥åº·å·¥å…·
5. **ç·Šæ€¥æƒ…æ³è™•ç†** - è‡ªæ®ºé é˜²å’Œå±æ©Ÿå¹²é 
6. **æºé€šé¢¨æ ¼** - æº«æš–è¦ªåˆ‡ã€å°ˆæ¥­å¯é ã€é¼“å‹µæ”¯æŒ
7. **å›æ‡‰çµæ§‹** - æƒ…ç·’èªåŒã€å°ˆæ¥­åˆ†æã€å¯¦ç”¨å»ºè­°ã€è³‡æºæ¨è–¦ã€é¼“å‹µæ”¯æŒ

## ğŸ”’ å®‰å…¨è€ƒæ…®

1. **ç·Šæ€¥æƒ…æ³è­˜åˆ¥** - è‡ªå‹•è­˜åˆ¥è‡ªæ®ºæƒ³æ³•å’Œåš´é‡æŠ‘é¬±
2. **å°ˆæ¥­è³‡æºæ¨è–¦** - æä¾›ç·Šæ€¥è¯ç¹«æ–¹å¼å’Œå°ˆæ¥­å¹«åŠ©
3. **æ•¸æ“šéš±ç§** - æœ¬åœ°å­˜å„²èŠå¤©è¨˜éŒ„ï¼Œä¿è­·ç”¨æˆ¶éš±ç§
4. **å®‰å…¨é‚Šç•Œ** - æ˜ç¢ºå‘ŠçŸ¥èƒ½åŠ›é‚Šç•Œï¼Œé¼“å‹µå°‹æ±‚å°ˆæ¥­å¹«åŠ©

## ğŸš¨ é‡è¦æé†’

âš ï¸ **å…è²¬è²æ˜**: æœ¬ç³»çµ±åƒ…ä¾›æ•™è‚²å’Œè‡ªæˆ‘é—œæ‡·åƒè€ƒä½¿ç”¨ï¼Œä¸èƒ½æ›¿ä»£å°ˆæ¥­çš„å¿ƒç†å¥åº·æœå‹™ã€‚å¦‚æœé‡åˆ°åš´é‡çš„æƒ…ç·’å•é¡Œæˆ–è‡ªæ®ºæƒ³æ³•ï¼Œè«‹ç«‹å³å°‹æ±‚å°ˆæ¥­å¿ƒç†å¥åº·æœå‹™ã€‚

## ğŸ¤ è²¢ç»æŒ‡å—

æ­¡è¿æäº¤Issueå’ŒPull Requestä¾†æ”¹é€²ç³»çµ±ï¼š

1. Fork é …ç›®
2. å‰µå»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. ç™¼èµ·Pull Request

## ğŸ“ æ”¯æŒèˆ‡è¯ç¹«

å¦‚æœ‰å•é¡Œæˆ–å»ºè­°ï¼Œè«‹é€šéä»¥ä¸‹æ–¹å¼è¯ç¹«ï¼š

- æäº¤GitHub Issue
- ç™¼é€éƒµä»¶è‡³é …ç›®ç¶­è­·è€…

---

**é¡˜æ¯å€‹äººéƒ½èƒ½æ“æœ‰å¥åº·çš„å¿ƒéˆ ğŸŒ±**
